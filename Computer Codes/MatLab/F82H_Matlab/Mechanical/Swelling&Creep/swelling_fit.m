clear all; close all;
fsize=14;msize=12;
f=[484.9529012	0.03385083;
530.4025762	0.107457315;
571.5197177	0.267528127;
598.5002213	0.433917216;
623.2061447	0.595700077;
652.5031562	0.785213482;
681.6464326	0.906827234;
728.1722532	0.95573129;
759.3315553	0.9677564;
798.3802613	0.964268244;
822.6179917	0.919265799;
841.0487294	0.809508281;
851.0240386	0.715269852;
861.3697095	0.534607859;
865.4960984	0.357096271;
872.4211642	0.165667001;
875.5168293	0.032919103;
];

p = polyfit(f(:,1),f(:,2),6)
x=linspace(500,900);
y=polyval(p,x);
pp=-3.86032249488434e-14.*x.^6+	1.53443531250638e-10.*x.^5	...
    -2.51945766068862e-07.*x.^4+	0.000218612371289000.*x.^3 ...
-0.105680996872491.*x.^2+	26.9834096463748.*x	-2843.24493908633
% figure( 'Name', 'Swelling fit' );
% plot(x,y)
% hold on
% plot(f(:,1),f(:,2),'o r')
% hold on
% plot(x,pp,'k',LineWidth=2)
ylim([0 1])
ylabel('F(T)','FontName','Times New Roman','FontSize',fsize)
xlabel('T [K]','FontName','Times New Roman','FontSize',fsize)


HT9=[0 0;
71.6092449058725	0.159509395572712;
130.577498987685	0.406671693664120;
197.929010592465	1.85075540891095;
247.719751092084	3.52594746263019;
346.627166104110	6.07758269148496;
449.041126467141	8.74276892170905;
545.778109095384	13.1207209114986;
650.294394134725	15.8996870765625  ;  
];

T91=[0 0;
    126.375854386866	0.0935193227003242;
249.938259504674	0.330150681148615;
348.221687726161	0.656495343350123;
452.102968551696	1.52401011313606;
551.085502358730	1.93583280988649;
651.445214074258	3.11775908472398;
35.7895122033941	0.203328912395819;
33.6282806718159	0.874461142458314;
183.360168364533	1.59787973502935;
202.497085929816	1.76489121102152;
207.410395688783	1.91362838777394;
207.791054473923	1.99922083207637;
207.651375458977	2.52174083785989;
207.687076165673	2.61183157120595];

% d=HT9(:,1);
% f=HT9(:,2);
% f_ht_type = fittype('A*d*(1-exp(-d/B))','dependent','f','independent','d',...
%     'coefficients',{'A','B'});
% f_p=fit(d,f,f_ht_type)
% figure( 'Name', 'Swelling Fit for HT9' );
% p1=plot(HT9(:,1),HT9(:,2),'o')
p1.MarkerFaceColor='r';
p1.MarkerSize=msize;
hold on
d1=0:500;
f1=0.003.*d1.*(1-exp(-d1/500));
r=10;
f2=0.003*(1+0.4*r).*d1.*(1-exp(-d1/(300-5*r)));
r=20;
f3=0.003*(1+0.4*r).*d1.*(1-exp(-d1/(300-5*r)));

plot(d1,f1,'k',LineWidth=2)
hold on
plot(d1,f2,'b',LineWidth=2)
hold on
plot(d1,f3,'r',LineWidth=2)
hold on
p2=plot(T91(:,1),T91(:,2),'o')
p2.MarkerFaceColor='r';
p2.MarkerSize=msize;
ylabel('Volumetric Swelling [%]','FontName','Times New Roman','FontSize',fsize)
xlabel('Dose [dpa]','FontName','Times New Roman','FontSize',fsize)
legend({'0 appHe/dpa','10 appmHe/dpa','20 appmHe/dpa)','Experiment'},...
 'Location','northwest','NumColumns',1,'FontSize',msize)
xlim([0 500])
ylim([0 5]) 

f_1=@(x) -3.86032249488434e-14.*x.^6+	1.53443531250638e-10.*x.^5	...
    -2.51945766068862e-07.*x.^4+	0.000218612371289000.*x.^3 ...
-0.105680996872491.*x.^2+	26.9834096463748.*x	-2843.24493908633;
f_2=@(d,r) 0.005*(1+r/10).*d.*(1-exp(-d/(300-5*r)));
f_3=@(x,d,r) f_1(x).*f_2(d,r)

% [X,Y] = meshgrid(500:50:900,0:200);
% Z = f_3(X,Y,10);
% surf(X,Y,Z)

